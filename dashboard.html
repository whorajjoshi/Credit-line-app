<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Credit Line | Dashboard</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');
*{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;}
body{display:flex;justify-content:center;align-items:center;height:100vh;background:linear-gradient(135deg,#0d47a1,#42a5f5);}
.container{background:#fff;width:400px;border-radius:20px;padding:40px 35px;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,0.2);}
h1{color:gold;font-weight:bold;margin-bottom:5px;font-size:24px;}
h3{color:#0d47a1;margin-bottom:25px;font-weight:600;}
p{font-size:16px;margin:10px 0;}
.btn{width:100%;padding:12px;margin-top:20px;background:linear-gradient(135deg,#0d47a1,#42a5f5);color:white;border:none;border-radius:10px;font-size:16px;font-weight:600;cursor:pointer;transition:0.3s;}
.btn:hover{background:linear-gradient(135deg,#08306b,#1e88e5);}
</style>
</head>
<body>

<div class="container">
  <h1>Credit Line</h1>
  <h3>Powered by ONLINEHUB India</h3>

  <p id="welcomeMsg">Welcome, User!</p>
  <p id="mobileDisplay"></p>
  
  <button class="btn" id="logoutBtn">Logout</button>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDf48c79QBIgWjNuqiRMywbj2wNYDnLIZ4",
    authDomain: "credit-line-app-23a0f.firebaseapp.com",
    projectId: "credit-line-app-23a0f",
    storageBucket: "credit-line-app-23a0f.firebasestorage.app",
    messagingSenderId: "72743508147",
    appId: "1:72743508147:web:039c06a12691b997cdf8c6"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const mobile = sessionStorage.getItem('mobile');
  if(!mobile){
    alert("No user logged in, redirecting to login.");
    window.location.href="index.html";
  } else {
    db.collection("users").doc(mobile).get().then(doc=>{
      if(doc.exists){
        const data = doc.data();
        document.getElementById("welcomeMsg").textContent = `Welcome, ${data.name}!`;
        document.getElementById("mobileDisplay").textContent = `Mobile: ${data.mobile}`;
      } else {
        alert("User not found! Redirecting to login.");
        sessionStorage.removeItem('mobile');
        window.location.href="index.html";
      }
    }).catch(err=>{
      alert("Error fetching user data. Redirecting to login.");
      sessionStorage.removeItem('mobile');
      window.location.href="index.html";
    });
  }

  document.getElementById("logoutBtn").addEventListener("click",()=>{
    sessionStorage.removeItem('mobile');
    alert("Logged out successfully!");
    window.location.href="index.html";
  });
</script>

</body>
</html>
